{
  "version": 3,
  "file": "UIView.js",
  "sourceRoot": "",
  "sources": [
    "@uirouter/react/components/UIView.tsx"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "/**\n * @reactapi\n * @module components\n */ /** */\nimport * as React from 'react';\nimport {\n  Component,\n  ValidationMap,\n  createElement,\n  cloneElement,\n  isValidElement,\n  ReactElement,\n  SFC,\n  ClassType,\n  StatelessComponent,\n  ComponentClass,\n  ClassicComponentClass,\n} from 'react';\nimport * as PropTypes from 'prop-types';\n\nimport {\n  ActiveUIView,\n  ViewContext,\n  ViewConfig,\n  Transition,\n  ResolveContext,\n  StateParams,\n  applyPairs,\n  extend,\n} from '@uirouter/core';\n\nimport { UIRouterReact } from '../index';\nimport { ReactViewConfig } from '../reactViews';\nimport { UIRouterInstanceUndefinedError } from './UIRouter';\n\n/** @internalapi */\nlet id = 0;\n\n/** @internalpi */\nexport interface UIViewAddress {\n  context: ViewContext;\n  fqn: string;\n}\n\n/**\n * Interface for [[InjectedProps.resolves]]\n *\n * This Typescript interface shows what fields are available on the `resolves` field.\n */\nexport interface UIViewResolves {\n  /**\n   * Any key/value pair defined by a state's resolve\n   *\n   * If a state defines any [[ReactStateDeclaration.resolve]]s, they will be found on this object.\n   */\n  [key: string]: any;\n  /**\n   * The `StateParams` for the `Transition` that activated the component\n   *\n   * This is an alias for:\n   * ```js\n   * let $stateParams = $transition$.params(\"to\");\n   * ```\n   */\n  $stateParams: StateParams;\n  /** The `Transition` that activated the component */\n  $transition$: Transition;\n}\n\n/**\n * Function type for [[UIViewProps.render]]\n *\n * If the `render` function prop is provided, the `UIView` will use it instead of rendering the component by itself.\n * @internalapi\n */\nexport type RenderPropCallback = (\n  Component:\n    | StatelessComponent<any>\n    | ComponentClass<any>\n    | ClassicComponentClass<any>,\n  Props: any,\n) => JSX.Element | null;\n\nexport interface UIViewInjectedProps {\n  transition?: Transition;\n  resolves?: UIViewResolves;\n  className?: string;\n  style?: Object;\n}\n\n/** Component Props for `UIView` */\nexport interface UIViewProps {\n  name?: string;\n  className?: string;\n  style?: Object;\n  render?: RenderPropCallback;\n}\n\n/** Component State for `UIView` */\nexport interface UIViewState {\n  id?: number;\n  loaded?: boolean;\n  component?:\n    | string\n    | SFC<any>\n    | ClassType<any, any, any>\n    | ComponentClass<any>;\n  props?: any;\n}\n\nexport const TransitionPropCollisionError = new Error(\n  '`transition` cannot be used as resolve token. ' +\n    'Please rename your resolve to avoid conflicts with the router transition.',\n);\n\nexport class UIView extends Component<UIViewProps, UIViewState> {\n  // This object contains all the metadata for this UIView\n  uiViewData: ActiveUIView;\n\n  // This object contains only the state context which created this <UIView/> component\n  // and the UIView's fully qualified name. This object is made available to children via `context`\n  uiViewAddress: UIViewAddress;\n\n  // Deregisters the UIView when it is unmounted\n  deregister: Function;\n\n  // Bind the rendered component instance in order to call its uiCanExit hook\n  componentInstance: any;\n  // Removes th Hook when the UIView is unmounted\n  removeHook: Function;\n\n  state: UIViewState = {\n    loaded: false,\n    component: 'div',\n    props: {},\n  };\n\n  static propTypes: ValidationMap<UIViewProps> = {\n    name: PropTypes.string,\n    className: PropTypes.string,\n    style: PropTypes.object,\n    render: PropTypes.func,\n  };\n\n  static childContextTypes: ValidationMap<any> = {\n    parentUIViewAddress: PropTypes.object,\n  };\n\n  static contextTypes: ValidationMap<any> = {\n    router: PropTypes.object,\n    parentUIViewAddress: PropTypes.object,\n  };\n\n  render() {\n    let { children, render } = this.props;\n    let { component, props, loaded } = this.state;\n    // register reference of child component\n    // register new hook right after component has been rendered\n    let stateName: string =\n      this.uiViewAddress &&\n      this.uiViewAddress.context &&\n      this.uiViewAddress.context.name;\n\n    // only class components can implement the\n    // uiCanExit hook and ref doesn't work on\n    // stateless function components\n    if (typeof component !== 'string' && !!component.prototype.render) {\n      props.ref = c => {\n        this.componentInstance = c;\n        this.registerUiCanExitHook(stateName);\n      };\n    }\n\n    // attach any style or className to the rendered component\n    // specified on the UIView itself\n    const { className, style } = this.props;\n    const styleProps = { className, style };\n    const childProps = { ...props, ...styleProps };\n\n    let child =\n      !loaded && isValidElement(children)\n        ? cloneElement(children, childProps)\n        : createElement(component, childProps);\n\n    // if a render function is passed use that,\n    // otherwise render the component normally\n    return typeof render !== 'undefined' && loaded\n      ? render(component, childProps)\n      : child;\n  }\n\n  getChildContext() {\n    return {\n      parentUIViewAddress: this.uiViewAddress,\n    };\n  }\n\n  componentWillMount() {\n    let router = this.context['router'];\n    if (typeof router === 'undefined') {\n      throw UIRouterInstanceUndefinedError;\n    }\n\n    // Check the context for the parent UIView's fqn and State\n    let parent: UIViewAddress = this.context['parentUIViewAddress'];\n    // Not found in context, this is a root UIView\n    parent = parent || { fqn: '', context: router.stateRegistry.root() };\n\n    let name = this.props.name || '$default';\n\n    this.uiViewData = {\n      $type: 'react',\n      id: ++id,\n      name: name,\n      fqn: parent.fqn ? parent.fqn + '.' + name : name,\n      creationContext: parent.context,\n      configUpdated: this.viewConfigUpdated.bind(this),\n      config: undefined,\n    } as ActiveUIView;\n\n    this.uiViewAddress = { fqn: this.uiViewData.fqn, context: undefined };\n\n    this.deregister = router.viewService.registerUIView(this.uiViewData);\n\n    this.setState({ id: this.uiViewData.id });\n  }\n\n  componentWillUnmount() {\n    this.deregister();\n  }\n\n  /**\n   * View config updated callback\n   *\n   * This is called by UI-Router during ViewService.sync().\n   * The `newConfig` parameter will contain view configuration (component, etc) when a\n   * state is activated and one of its views targets this `UIView`.\n   */\n  viewConfigUpdated(newConfig: ReactViewConfig) {\n    if (newConfig === this.uiViewData.config) {\n      return;\n    }\n\n    let trans: Transition;\n    let resolves = {};\n\n    if (newConfig) {\n      let viewContext: ViewContext = newConfig.viewDecl && newConfig.viewDecl.$context;\n      this.uiViewAddress = { fqn: this.uiViewAddress.fqn, context: viewContext };\n\n      let resolveContext = new ResolveContext(newConfig.path);\n      let injector = resolveContext.injector();\n\n      let stringTokens: string[] = resolveContext.getTokens()\n          .filter(x => typeof x === 'string');\n      if (stringTokens.indexOf('transition') !== -1) {\n        throw TransitionPropCollisionError;\n      }\n\n      trans = injector.get(Transition);\n      resolves = stringTokens\n        .map(token => [token, injector.get(token)])\n        .reduce(applyPairs, {});\n    }\n\n    this.uiViewData.config = newConfig;\n    let props = { ...resolves, transition: trans };\n\n    let newComponent = newConfig && newConfig.viewDecl && newConfig.viewDecl.component;\n    this.setState({\n      component: newComponent || 'div',\n      props: newComponent ? props : {},\n      loaded: !!newComponent,\n    });\n  }\n\n  registerUiCanExitHook(stateName: string) {\n    typeof this.removeHook === 'function' && this.removeHook();\n    let criteria = { exiting: stateName };\n    let callback =\n      this.componentInstance &&\n      typeof this.componentInstance.uiCanExit === 'function' &&\n      this.componentInstance.uiCanExit;\n    if (stateName && callback) {\n      let transitions = this.context['router'].transitionService;\n      this.removeHook = transitions.onBefore(criteria, callback, {});\n    }\n  }\n}\n"
  ]
}